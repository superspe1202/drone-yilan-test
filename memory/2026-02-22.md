# 2026-02-22 å·¥ä½œæ—¥èªŒ

## 591 åœŸåœ°åœ°åœ–

### ä»»å‹™
- ç›®æ¨™ï¼šå¾ 591åœŸåœ°ç¶²ç«™ (land.591.com.tw) å–å¾—æ­¦æ·µäºŒæ®µ 1087 ç­†åœŸåœ°è³‡æ–™
- æ‰€éœ€æ¬„ä½ï¼šåœŸåœ°ä¸­å¿ƒé»åº§æ¨™ã€åœŸåœ°é¢ç©ã€åœŸåœ°é‚Šç·£å¤–æ¡† (GeoJSON polygon)

### æŠ€è¡“ç‹€æ…‹
- ä½¿ç”¨ Peekaboo æ§åˆ¶ Chrome
- ç¶²ç«™å·²æ‰“é–‹ï¼Œæ­¦æ·µæœ‰ 1087 ç­†åœŸåœ°
- éœ€è¦æ‰“é–‹ DevTools Network æ¨™ç±¤ä¾†ç›£è½ API è«‹æ±‚

### å¾…è¾¦
- [ ] æ‰“é–‹é–‹ç™¼è€…å·¥å…· Network æ¨™ç±¤
- [ ] é‡æ–°æ•´ç†é é¢ï¼Œæ“·å– API è«‹æ±‚
- [ ] è§£æ API å›å‚³è³‡æ–™çµæ§‹
- [ ] è‡ªå‹•åŒ–æ“·å–åœŸåœ°è³‡æ–™

## GitHub
- drone-farm-quote repo: https://github.com/superspe1202/drone-farm-quote
- GitHub Pages: https://superspe1202.github.io/drone-farm-quote/

## 591 API é€†å‘å·¥ç¨‹çªç ´ (15:54 æ›´æ–°)

### å·²ç ´è§£çš„é—œéµ
1. **JS æ¨¡çµ„**: `https://s.591.com.tw/map/CV-9uBi5.js` â€” å¯ç›´æ¥ `import()` ä½¿ç”¨
2. **ç°½åå‡½æ•¸ pt**: åŒ¯å‡ºå `fN` â€” ç”¨ key `5f0d5ff448`, SHA-256 + salt æ··å…¥
3. **è§£å¯†å‡½æ•¸ vt**: åŒ¯å‡ºå `fO` â€” AES-GCM è§£å¯† API å›æ‡‰
4. **Headers å‡½æ•¸ Te**: åŒ¯å‡ºå `f9` â€” è¿”å› `{device, deviceid, user-id}`

### å¯ç”¨ API ç«¯é» (domain: bff-business.591.com.tw)
- `/v2/web/land-transcript/map/list` â€” åœ°ç±åˆ—è¡¨ï¼ˆ**åˆ†é å£çš„ï¼Œæ¯é éƒ½è¿”å›åŒæ¨£è³‡æ–™**ï¼‰
- `/v2/web/land-transcript/map/search` â€” åœ°ç±æœå°‹ï¼ˆ**éœ€è¦ `layer` å’Œ `point` åƒæ•¸**ï¼‰
- `/v1/web/land-gis/segment-polygon` â€” æ®µè½å¤šé‚Šå½¢
- `/v2/web/map/land/shape` â€” å–®ç­†åœ°è™Ÿå½¢ç‹€ï¼ˆç”¨ lat/lon æŸ¥è©¢ï¼‰
- `/v1/web/land-transcript/map/detail` â€” åœ°è™Ÿè©³æƒ…

### map/search æˆåŠŸå‘¼å«ç¯„ä¾‹
```javascript
const body = {
  region_id: 21, section_id: 337,
  segment_id: '5846', small_segment_id: '6766',
  layer: 4, page: 1, page_size: 200,
  point: [[24.68,121.81],[24.68,121.77],[24.64,121.77],[24.64,121.81]]
};
```
- è¿”å› 500 ç­†ï¼ˆä½†å«å…¶ä»–æ®µçš„è³‡æ–™ï¼Œå›  bounding box å¤ªå¤§ï¼‰
- æ¯ç­†æœ‰: id, land_number, lat, lng, unit_price, reg_date ç­‰
- **æ²’æœ‰ areaï¼ˆé¢ç©ï¼‰**ï¼Œé¢ç©åœ¨ `map/list` ç«¯é»æ‰æœ‰

### map/list å›å‚³æ¬„ä½ï¼ˆå®Œæ•´ï¼‰
id, region_id, section_id, segment_id, small_segment_id, address, **areaï¼ˆåªï¼‰**, price, unit_price, unit_price_date, present_unit_price_year_1, region_name, section_name, **land_number**, land_type, is_urban_land, land_zone, land_use_type, ware_id, trend_price_id, **lat, lng**, reg_date, land_type_name, **land_zone_txt**, unit

### ç•¶å‰é€²åº¦
- âœ… æˆåŠŸå‘¼å« API ä¸¦è§£å¯†å›æ‡‰
- âœ… `map/list` ç¬¬ä¸€é è¿”å› 150 ç­†ï¼ˆå«é¢ç©ï¼‰ï¼Œä½†åˆ†é ä¸ workï¼ˆæ¯é åŒæ¨£è³‡æ–™ï¼‰
- âœ… `map/search` ç”¨ layer=4 + point å¯æ‹¿åˆ° 500 ç­†ï¼Œä½†ç¼ºé¢ç©
- ğŸ”² éœ€è¦è§£æ±ºï¼šå¦‚ä½•å–å¾—å…¨éƒ¨ 1087 ç­†çš„å®Œæ•´è³‡æ–™ï¼ˆå«é¢ç©+åº§æ¨™+é‚Šç•Œï¼‰
- ğŸ”² é‚Šç•Œå¤šé‚Šå½¢ï¼šå¯èƒ½è¦ç”¨ `/v2/web/map/land/shape` é€ç­†æŸ¥

### ç­–ç•¥æ€è€ƒ
1. `map/list` æœ‰é¢ç©ä½†åˆ†é å£ â†’ å¯èƒ½éœ€æ”¹ sort åƒæ•¸æˆ–å…¶ä»–æ–¹å¼ç¹é
2. `map/search` å¯åˆ†å€åŸŸæŸ¥ï¼ˆç”¨ä¸åŒ bounding boxï¼‰â†’ æ‹¼æ¹Šå…¨éƒ¨è³‡æ–™
3. æˆ–è€…ç”¨ `map/list` çš„ 100 ç­† + `map/search` è£œé½Šå‰©é¤˜çš„
4. é‚Šç•Œåº§æ¨™éœ€è¦é€ç­†ç”¨ lat/lng å‘¼å« `/v2/web/map/land/shape`

### Browser ç‹€æ…‹
- Profile: openclaw
- targetId: `450DEF7DD5323D9C7B6B943E555720B4`
- é é¢: 591 åœŸåœ°åœ°åœ– æ­¦æ·µäºŒæ®µ
- `window._591` å·²å¿«å– pt/decrypt/Te å‡½æ•¸
- `window._allParcels` æœ‰è³‡æ–™ï¼ˆä½†éœ€è¦é‡æ–°æ•´ç†ï¼‰

## æ³¨æ„äº‹é¡¹
- å›è¦†æ™‚ä½¿ç”¨ç¹é«”ä¸­æ–‡
- ä½¿ç”¨ Peekaboo è‡ªå·±æ“ä½œè¢å¹•

---

## ğŸ“‹ å¾…å®Œæˆï¼šé‡æ–°çˆ¬å–æ­¦æ·µåœŸåœ°åªæ•¸+é‚Šç•Œ

### ç¾æ³
- ç›®å‰è³‡æ–™åº«ä¸­æ­¦æ·µæ®µæ²’æœ‰åªæ•¸è³‡æ–™ (area éƒ½ null)
- éœ€é‡æ–°å¾ 591 API æŠ“å–

### çˆ¬èŸ²é‡é»
- **API Domain**: bff-business.591.com.tw
- **ç°½å**: `pt` å‡½æ•¸ (key: `5f0d5ff448`, SHA-256 + salt)
- **è§£å¯†**: `vt` å‡½æ•¸ (AES-GCM)

### éœ€ä½¿ç”¨ç«¯é»
1. `/v2/web/land-transcript/map/list` - æœ‰åªæ•¸ï¼ˆä½†åˆ†é æœ‰å•é¡Œï¼Œéœ€ç¹éï¼‰
2. `/v2/web/map/land/shape` - å–®ç­†é‚Šç•Œå¤šé‚Šå½¢ï¼ˆç”¨ lat/lng æŸ¥è©¢ï¼‰

### ç”¢å‡ºç›®æ¨™
- ä¸­å¿ƒé» (lat, lng)
- åªæ•¸ (area)
- é‚Šç•Œå¤šé‚Šå½¢ (GeoJSON polygon)

### ç­–ç•¥å»ºè­°
1. å…ˆç”¨ `map/search` æ‹¿æ‰€æœ‰åœŸåœ°çš„ lat/lng
2. å†ç”¨ `map/list` æ‹¿åªæ•¸ï¼ˆéœ€è§£æ±ºåˆ†é å•é¡Œï¼‰
3. æœ€å¾Œé€ç­†ç”¨ `/v2/web/map/land/shape` æŠ“é‚Šç•Œ

---

## ğŸ“Š æ­¦æ·µäºŒæ®µè³‡æ–™ç¾æ³ (æ›´æ–°)

### æœ€çµ‚ç”¢å‡º
- **wuyuan2_full.json** - å®Œæ•´èµ„æ–™ï¼ˆä¸­å¿ƒåº§æ ‡ + åªæ•° + è¾¹ç•Œï¼‰
  - æ€»ç¬”æ•°: 1,126
  - æœ‰åªæ•°: 958
  - æœ‰è¾¹ç•Œ: 1,126 âœ…

### èµ„æ–™æ¥æº
- ä¸­å¿ƒåº§æ ‡: index.html (baxian_cadas_matched.json)
- åªæ•°: index.html (areaMap) - 958 ç¬”
- è¾¹ç•Œ: baxian_boundaries_final.json - 1,125 ç¬”

### å…¶ä»–ç›¸å…³æ–‡ä»¶
- wuyuan2_complete.json - ä¸­å¿ƒåº§æ ‡ + åªæ•°ï¼ˆæ— è¾¹ç•Œï¼‰
- baxian_boundaries_final.json - è¾¹ç•Œèµ„æ–™ (GeoJSON)
